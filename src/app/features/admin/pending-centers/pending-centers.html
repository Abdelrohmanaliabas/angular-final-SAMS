<section
    class="max-w-[1100px] mx-auto my-6 p-5 max-[400px]:p-3 bg-[var(--card)] rounded-2xl border border-[var(--glass-border)] shadow-[0_18px_40px_rgba(0,0,0,0.08)] backdrop-blur-xl text-[var(--text)]">
    <header class="mb-4">
        <h2 class="text-2xl font-bold">Pending Centers</h2>
        <p class="text-[var(--muted)] text-sm">Review and approve center registration requests</p>
    </header>

    <div class="flex justify-between items-center my-3 gap-3 max-[500px]:flex-col max-[500px]:items-stretch">
        <input placeholder="Search requests..."
            class="px-3 py-2 rounded-lg border border-[var(--glass-border)] w-[260px] bg-[var(--glass)] text-[var(--text)] max-[500px]:w-full focus:outline-none focus:border-[var(--primary)] transition-colors"
            [(ngModel)]="searchTerm" (ngModelChange)="onSearchChange()" />
        <div class="inline-flex items-center max-[500px]:justify-between gap-2">
            <label class="text-[var(--muted)] text-sm">Per page</label>
            <select
                class="px-2.5 py-1.5 rounded-lg border border-[var(--glass-border)] bg-[var(--glass)] text-[var(--text)] focus:outline-none"
                [(ngModel)]="perPage" (ngModelChange)="onPerPageChange($event)">
                <option [ngValue]="10">10</option>
                <option [ngValue]="15">15</option>
                <option [ngValue]="25">25</option>
                <option [ngValue]="50">50</option>
            </select>
        </div>
    </div>

    <div class="flex items-center gap-2.5 p-3 bg-[var(--glass)] border border-[var(--glass-border)] rounded-xl mb-2"
        *ngIf="isLoading()">
        <div class="w-[18px] h-[18px] border-[3px] border-black/10 border-t-[var(--primary)] rounded-full animate-spin">
        </div>
        <span>Loading requests...</span>
    </div>

    <div class="flex flex-col items-center justify-center py-12 text-center text-[var(--muted)]"
        *ngIf="!isLoading() && pendingCenters().length === 0">
        <div class="text-4xl mb-4 text-green-500">✓</div>
        <h3 class="text-lg font-bold text-[var(--text)] mb-2">All Caught Up!</h3>
        <p>There are no pending center registration requests at the moment.</p>
    </div>

    <table
        class="w-full border-collapse mt-2.5 bg-[var(--card)] border border-[var(--glass-border)] rounded-xl overflow-hidden shadow-sm max-[1200px]:block max-[1200px]:bg-transparent max-[1200px]:border-none max-[1200px]:shadow-none"
        *ngIf="!isLoading() && pendingCenters().length > 0">
        <thead class="max-[1200px]:hidden">
            <tr>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Center Name</th>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Owner</th>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Email</th>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Phone</th>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Date</th>
                <th
                    class="p-3 text-left border-b border-[var(--glass-border)] bg-[var(--glass)] font-bold text-[var(--muted)]">
                    Actions</th>
            </tr>
        </thead>
        <tbody
            class="max-[1200px]:grid max-[1200px]:grid-cols-[repeat(auto-fill,minmax(280px,1fr))] max-[1200px]:gap-4 max-[1200px]:w-full">
            <tr *ngFor="let center of filteredCenters"
                class="max-[1200px]:flex max-[1200px]:flex-col max-[1200px]:bg-[var(--card)] max-[1200px]:border max-[1200px]:border-[var(--glass-border)] max-[1200px]:rounded-2xl max-[1200px]:p-4 max-[400px]:p-3 max-[1200px]:shadow-sm max-[1200px]:h-full">
                <td class="p-3 border-b border-[var(--glass-border)] align-middle font-bold text-[var(--text)] max-[1200px]:flex max-[1200px]:justify-between max-[1200px]:items-center max-[1200px]:gap-4 max-[1200px]:w-full max-[1200px]:py-3 max-[1200px]:px-0 max-[1200px]:text-right max-[1200px]:before:content-[attr(data-label)] max-[1200px]:before:font-semibold max-[1200px]:before:text-[var(--muted)] max-[1200px]:before:mr-auto max-[1200px]:before:text-left"
                    data-label="Center Name">
                    <div class="flex items-center gap-3 max-[1200px]:justify-end">
                        <div
                            class="w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center text-white font-bold text-lg shadow-sm">
                            {{ center.centerName.charAt(0).toUpperCase() }}
                        </div>
                        <span class="font-bold text-[var(--text)]">{{ center.centerName }}</span>
                    </div>
                </td>
                <td class="p-3 border-b border-[var(--glass-border)] align-middle max-[1200px]:flex max-[1200px]:justify-between max-[1200px]:items-center max-[1200px]:gap-4 max-[1200px]:w-full max-[1200px]:py-3 max-[1200px]:px-0 max-[1200px]:text-right max-[1200px]:before:content-[attr(data-label)] max-[1200px]:before:font-semibold max-[1200px]:before:text-[var(--muted)] max-[1200px]:before:mr-auto max-[1200px]:before:text-left"
                    data-label="Owner">
                    <span class="text-[var(--text)]">{{ center.name }}</span>
                </td>
                <td class="p-3 border-b border-[var(--glass-border)] align-middle max-[1200px]:flex max-[1200px]:justify-between max-[1200px]:items-center max-[1200px]:gap-4 max-[1200px]:w-full max-[1200px]:py-3 max-[1200px]:px-0 max-[1200px]:text-right max-[1200px]:before:content-[attr(data-label)] max-[1200px]:before:font-semibold max-[1200px]:before:text-[var(--muted)] max-[1200px]:before:mr-auto max-[1200px]:before:text-left"
                    data-label="Email">
                    <span class="text-sm text-[var(--text)]">{{ center.email }}</span>
                </td>
                <td class="p-3 border-b border-[var(--glass-border)] align-middle max-[1200px]:flex max-[1200px]:justify-between max-[1200px]:items-center max-[1200px]:gap-4 max-[1200px]:w-full max-[1200px]:py-3 max-[1200px]:px-0 max-[1200px]:text-right max-[1200px]:before:content-[attr(data-label)] max-[1200px]:before:font-semibold max-[1200px]:before:text-[var(--muted)] max-[1200px]:before:mr-auto max-[1200px]:before:text-left"
                    data-label="Phone">
                    <span class="text-sm text-[var(--text)]">{{ center.phone }}</span>
                </td>
                <td class="p-3 border-b border-[var(--glass-border)] align-middle max-[1200px]:flex max-[1200px]:justify-between max-[1200px]:items-center max-[1200px]:gap-4 max-[1200px]:w-full max-[1200px]:py-3 max-[1200px]:px-0 max-[1200px]:text-right max-[1200px]:before:content-[attr(data-label)] max-[1200px]:before:font-semibold max-[1200px]:before:text-[var(--muted)] max-[1200px]:before:mr-auto max-[1200px]:before:text-left"
                    data-label="Date">
                    <span class="text-sm text-[var(--muted)]">{{ formatDate(center.createdAt) }}</span>
                </td>
                <td class="p-3 border-b border-[var(--glass-border)] align-middle max-[1200px]:flex max-[1200px]:justify-center max-[1200px]:items-center max-[1200px]:w-full max-[1200px]:pt-4 max-[1200px]:pb-0 max-[1200px]:mt-auto max-[1200px]:border-none"
                    data-label="Actions">
                    <div class="flex gap-2 w-full max-w-[200px] max-[1200px]:max-w-full">
                        <button
                            class="flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 rounded-lg bg-green-500 text-white font-medium hover:bg-green-600 transition-colors shadow-sm"
                            (click)="approve(center)">
                            Approve
                        </button>
                        <button
                            class="flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 rounded-lg bg-[var(--glass)] border border-red-200 text-red-500 font-medium hover:bg-red-50 transition-colors shadow-sm cursor-pointer relative z-10"
                            (click)="openRejectModal(center); $event.stopPropagation()">
                            Reject
                        </button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>

</section>

<div class="max-w-[1100px] mx-auto flex justify-between items-center mt-4 gap-3 bg-[var(--glass)] border border-[var(--glass-border)] p-2.5 rounded-xl max-[450px]:flex-col max-[450px]:items-center"
    *ngIf="lastPage > 1 || total">
    <div class="text-[var(--muted)] text-sm">Showing {{ (page - 1) * perPage + 1 }} - {{ page * perPage > total ? total
        :
        page * perPage }} of {{ total }}</div>
    <div class="inline-flex items-center gap-2.5">
        <button
            class="bg-[var(--glass)] border border-[var(--glass-border)] px-3.5 py-1.5 rounded-full cursor-pointer text-[var(--text)] shadow-sm hover:-translate-y-px hover:bg-purple-500/10 hover:border-purple-500/30 hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:transform-none"
            [disabled]="page === 1" (click)="onPageChange(page - 1)">Prev</button>
        <span class="font-bold">Page {{ page }} / {{ lastPage }}</span>
        <button
            class="bg-[var(--glass)] border border-[var(--glass-border)] px-3.5 py-1.5 rounded-full cursor-pointer text-[var(--text)] shadow-sm hover:-translate-y-px hover:bg-purple-500/10 hover:border-purple-500/30 hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:transform-none"
            [disabled]="page === lastPage" (click)="onPageChange(page + 1)">Next</button>
    </div>
</div>

<!-- Reject Modal -->
<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-[9999] p-4" *ngIf="rejectModalOpen()">
    <div class="bg-[var(--card)] rounded-2xl w-full max-w-[480px] shadow-xl overflow-hidden relative z-[10000]">
        <div class="flex items-center justify-between p-5 border-b border-[var(--glass-border)]">
            <h2 class="text-lg font-bold text-red-500 flex items-center gap-2 m-0">
                Reject Center
            </h2>
            <button
                class="bg-transparent border-none text-xl text-[var(--muted)] cursor-pointer hover:text-[var(--text)]"
                (click)="closeRejectModal()">×</button>
        </div>

        <div class="p-5">
            <label class="block mb-2 font-medium text-[var(--text)]">Reason for rejection (optional)</label>
            <textarea
                class="w-full p-3 border border-[var(--glass-border)] rounded-lg resize-y font-inherit text-[0.95rem] bg-[var(--glass)] text-[var(--text)] focus:outline-none focus:border-red-500 min-h-[100px]"
                [(ngModel)]="rejectReason" placeholder="Enter reason..."></textarea>
        </div>

        <div class="flex gap-3 p-5 border-t border-[var(--glass-border)]">
            <button
                class="flex-1 p-3 border border-[var(--glass-border)] rounded-lg bg-[var(--glass)] text-[var(--text)] cursor-pointer font-medium hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                (click)="closeRejectModal()">Cancel</button>
            <button
                class="flex-1 flex items-center justify-center gap-2 p-3 border-none rounded-lg bg-red-500 text-white cursor-pointer font-medium hover:bg-red-600 transition-colors"
                (click)="confirmReject()">
                Confirm Reject
            </button>
        </div>
    </div>
</div>