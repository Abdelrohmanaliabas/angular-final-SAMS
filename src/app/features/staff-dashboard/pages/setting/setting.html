<section class="page-container settings-wrapper" [class.rtl]="preferences.language === 'ar'">
  <!-- Header -->
  <header class="settings-header">
    <div>
      <h2 class="settings-title">
        {{ preferences.language === 'ar' ? 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' : 'Settings' }}
      </h2>
      <p class="settings-subtitle">
        {{
          preferences.language === 'ar'
            ? 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ Ø§Ù„Ù…Ø¸Ù‡Ø±ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø£Ù…Ø§Ù†.'
            : 'Manage your account, appearance, notifications and security.'
        }}
      </p>
    </div>

    <div class="pill-badge">
      <span class="dot"></span>
      {{ preferences.language === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}
    </div>
  </header>

  <!-- Layout: Ø¹Ù…ÙˆØ¯ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© -->
  <div class="settings-layout">
    <!-- Left column -->
    <div class="settings-column">
      <!-- Account -->
      <section class="settings-card">
        <div class="card-header">
          <h3>
            {{ preferences.language === 'ar' ? 'Ø§Ù„Ø­Ø³Ø§Ø¨' : 'Account' }}
          </h3>
          <p>
            {{
              preferences.language === 'ar'
                ? 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø¹Ù† Ø­Ø³Ø§Ø¨Ùƒ.'
                : 'Basic information about your profile.'
            }}
          </p>
        </div>

        <div class="account-row">
          <div class="avatar-block">
            <div class="avatar">
              <img [src]="user.avatar" [alt]="user.name" />
            </div>
            <button type="button" class="btn-secondary small">
              {{ preferences.language === 'ar' ? 'ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©' : 'Change photo' }}
            </button>
          </div>

          <div class="account-fields">
            <div class="field">
              <label>{{ preferences.language === 'ar' ? 'Ø§Ù„Ø§Ø³Ù…' : 'Name' }}</label>
              <input type="text" [(ngModel)]="user.name" />
            </div>

            <div class="field">
              <label>{{ preferences.language === 'ar' ? 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ' : 'Email' }}</label>
              <input type="email" [(ngModel)]="user.email" />
            </div>

            <div class="field">
              <label>{{ preferences.language === 'ar' ? 'Ø§Ù„Ø£Ø¯ÙˆØ§Ø±' : 'Roles' }}</label>
              <input type="text" [ngModel]="rolesInput" (ngModelChange)="onRolesInputChange($event)"
                placeholder="admin, teacher" />
            </div>

            <div class="actions-right">
              <button type="button" class="btn-primary" (click)="saveAccount()">
                {{ preferences.language === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨' : 'Save account' }}
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Security -->
      <section class="settings-card">
        <div class="card-header">
          <h3>
            {{ preferences.language === 'ar' ? 'Ø§Ù„Ø£Ù…Ø§Ù†' : 'Security' }}
          </h3>
          <p>
            {{
              preferences.language === 'ar'
                ? 'ØªØ­ÙƒÙ… ÙÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©.'
                : 'Control password and extra protection.'
            }}
          </p>
        </div>

        <div class="field-inline">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±' : 'Password' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ù‚Ù… Ø¨ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø­Ø³Ø§Ø¨Ùƒ.'
                  : 'Change your account password.'
              }}
            </p>
          </div>
          <button type="button" class="btn-secondary" (click)="changePassword()">
            {{ preferences.language === 'ar' ? 'ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±' : 'Change password' }}
          </button>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{
                preferences.language === 'ar'
                  ? 'Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ø®Ø·ÙˆØªÙŠÙ†'
                  : 'Two-factor authentication'
              }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ø£Ø¶Ù Ø·Ø¨Ù‚Ø© Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø­Ø³Ø§Ø¨Ùƒ.'
                  : 'Add extra security to your account.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="security.twoFactor" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="security-footer">
          <p class="danger-title">
            {{ preferences.language === 'ar' ? 'Ù…Ù†Ø·Ù‚Ø© Ø­Ø³Ù‘Ø§Ø³Ø©' : 'Danger zone' }}
          </p>
          <p class="danger-text">
            {{
              preferences.language === 'ar'
                ? 'ØªØ¹Ø·ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø£Ùˆ Ø·Ù„Ø¨ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.'
                : 'Deactivate your account or request data removal.'
            }}
          </p>
          <button type="button" class="btn-danger small">
            {{ preferences.language === 'ar' ? 'ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨' : 'Deactivate account' }}
          </button>
        </div>
      </section>
    </div>

    <!-- Right column -->
    <div class="settings-column">
      <!-- Preferences -->
      <section class="settings-card">
        <div class="card-header">
          <h3>
            {{ preferences.language === 'ar' ? 'Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª' : 'Preferences' }}
          </h3>
          <p>
            {{
              preferences.language === 'ar'
                ? 'ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø¸Ù‡Ø± ÙˆØ§Ù„Ù„ØºØ© ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ø±Ø¶.'
                : 'Control appearance, language and layout.'
            }}
          </p>
        </div>

        <div class="field">
          <label>{{ preferences.language === 'ar' ? 'Ø§Ù„Ù…Ø¸Ù‡Ø±' : 'Theme' }}</label>
          <div style="display:flex;gap:.5rem;align-items:center">
            <select [(ngModel)]="preferences.theme" (ngModelChange)="onThemeChange($event)">
              <option value="light">
                {{ preferences.language === 'ar' ? 'ÙØ§ØªØ­' : 'Light' }}
              </option>
              <option value="dark">
                {{ preferences.language === 'ar' ? 'Ø¯Ø§ÙƒÙ†' : 'Dark' }}
              </option>
              <option value="system">
                {{ preferences.language === 'ar' ? 'Ø­Ø³Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù…' : 'System default' }}
              </option>
            </select>
            <!-- quick toggle -->
            <div style="display:flex;gap:.4rem">
              <button type="button" class="btn-secondary small" (click)="onThemeChange('light')">â˜€ï¸</button>
              <button type="button" class="btn-secondary small" (click)="onThemeChange('dark')">ğŸŒ™</button>
            </div>
          </div>
        </div>

        <div class="field">
          <label>{{ preferences.language === 'ar' ? 'Ø§Ù„Ù„ØºØ©' : 'Language' }}</label>
          <select [(ngModel)]="preferences.language" (ngModelChange)="onLanguageChange($event)">
            <option value="en">English</option>
            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          </select>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'ØªÙ†Ø³ÙŠÙ‚ 24 Ø³Ø§Ø¹Ø©' : '24-hour time' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ø¹Ø±Ø¶ Ø§Ù„ÙˆÙ‚Øª Ø¨ØµÙŠØºØ© 13:00 Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 1:00 PM.'
                  : 'Show time in 24h format (13:00).'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="preferences.use24hTime" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{
                preferences.language === 'ar'
                  ? 'Ø´Ø±ÙŠØ· Ø¬Ø§Ù†Ø¨ÙŠ Ù…Ø¶ØºÙˆØ·'
                  : 'Compact sidebar'
              }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©.'
                  : 'Reduce spacing in the left navigation.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="preferences.compactSidebar" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="actions-right">
          <button type="button" class="btn-primary" (click)="savePreferences()">
            {{ preferences.language === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„ØªÙØ¶ÙŠÙ„Ø§Øª' : 'Save preferences' }}
          </button>
        </div>
      </section>

      <!-- Notifications -->
      <section class="settings-card">
        <div class="card-header">
          <h3>
            {{ preferences.language === 'ar' ? 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª' : 'Notifications' }}
          </h3>
          <p>
            {{
              preferences.language === 'ar'
                ? 'ÙƒÙŠÙ ØªØ³ØªÙ‚Ø¨Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙˆØ§Ù„Ø¥Ù†Ø°Ø§Ø±Ø§Øª.'
                : 'How you get notified about updates.'
            }}
          </p>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ' : 'Email notifications' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ø§Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø¹Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ.'
                  : 'Receive updates on your email.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="notifications.email" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'Ø±Ø³Ø§Ø¦Ù„ SMS' : 'SMS notifications' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚ØµÙŠØ±Ø© Ù„Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©.'
                  : 'Use SMS for critical alerts.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="notifications.sms" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…' : 'In-app notifications' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'Ø¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¯Ø§Ø®Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….'
                  : 'Show notifications inside the dashboard.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="notifications.inApp" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="toggle-row">
          <div>
            <p class="toggle-title">
              {{ preferences.language === 'ar' ? 'ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ØºÙŠØ§Ø¨' : 'Attendance alerts' }}
            </p>
            <p class="toggle-sub">
              {{
                preferences.language === 'ar'
                  ? 'ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ Ø²ÙŠØ§Ø¯Ø© Ù†Ø³Ø¨Ø© ØºÙŠØ§Ø¨ Ø·Ø§Ù„Ø¨.'
                  : 'Alert when student absence increases.'
              }}
            </p>
          </div>
          <label class="toggle">
            <input type="checkbox" [(ngModel)]="notifications.attendanceAlerts" />
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div class="actions-right">
          <button type="button" class="btn-primary" (click)="saveNotifications()">
            {{ preferences.language === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª' : 'Save notifications' }}
          </button>
        </div>
      </section>
    </div>
  </div>
</section>
